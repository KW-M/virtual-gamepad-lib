import{G as O,a as R,D as q,d as V,b as m,c as o,C as F}from"./GamepadApiWrapper-Wfngy3DR.js";import{G as W}from"./GamepadDisplay-DRbWnvMw.js";const a=new O(.1),j=new R({updateDelay:0,axisDeadZone:.05}),c=document.body,x=8,b=0,P=1,T=2,I=3,M=["button_1","button_2","button_3","button_4","shoulder_button_front_left","shoulder_button_front_right","shoulder_trigger_back_left","shoulder_trigger_back_right","select_button","start_button","stick_button_left","stick_button_right","d_pad_up","d_pad_down","d_pad_left","d_pad_right"];function z(t,e){const s=M.map((h,l)=>h.includes("trigger")?{buttonIndex:l,type:m.variable,tapTarget:e.querySelector("#"+h+"_touch_target"),dragDistance:50,lockTargetWhilePressed:!0,directions:{[o.up]:!1,[o.down]:!0,[o.left]:!1,[o.right]:!1}}:{buttonIndex:l,type:m.onOff,lockTargetWhilePressed:h.includes("stick"),tapTarget:e.querySelector("#"+h+"_touch_target")});a.AddDisplayButtonEventListeners(t,s);const n=[{tapTarget:e.querySelector("#stick_button_left_touch_target"),dragDistance:30,xAxisIndex:0,yAxisIndex:1,lockTargetWhilePressed:!0,directions:{[o.up]:!0,[o.down]:!1,[o.left]:!0,[o.right]:!0}},{tapTarget:e.querySelector("#stick_button_right_touch_target"),dragDistance:30,xAxisIndex:2,yAxisIndex:3,lockTargetWhilePressed:!0,directions:{[o.up]:!0,[o.down]:!0,[o.left]:!0,[o.right]:!0}}];a.AddDisplayJoystickEventListeners(t,n)}function H(t){document.querySelectorAll("#stick_right, #stick_left").forEach(n=>{F(n)});const e=M.map((n,h)=>(console.log(n),n.includes("trigger")?{type:m.variable,highlight:c.querySelector("#"+n+"_highlight"),buttonElement:c.querySelector("#"+n),direction:o.down,directionHighlight:c.querySelector("#"+n+"_direction_highlight"),movementRange:10,extraData:{myCustomData:"variable btn name is "+n}}:{type:m.onOff,highlight:c.querySelector("#"+n+"_highlight"),extraData:{myCustomData:"onOff btn name is "+n}})),s=[{joystickElement:c.querySelector("#stick_left"),xAxisIndex:0,yAxisIndex:1,movementRange:10,highlights:{[o.up]:c.querySelector("#l_stick_up_direction_highlight"),[o.down]:c.querySelector("#l_stick_down_direction_highlight"),[o.left]:c.querySelector("#l_stick_left_direction_highlight"),[o.right]:c.querySelector("#l_stick_right_direction_highlight")}},{joystickElement:c.querySelector("#stick_right"),xAxisIndex:2,yAxisIndex:3,movementRange:10,highlights:{[o.up]:c.querySelector("#r_stick_up_direction_highlight"),[o.down]:c.querySelector("#r_stick_down_direction_highlight"),[o.left]:c.querySelector("#r_stick_left_direction_highlight"),[o.right]:c.querySelector("#r_stick_right_direction_highlight")}}];new W({gamepadIndex:t,pressedHighlightClass:"pressed",touchedHighlightClass:"touched",moveDirectionHighlightClass:"moved",buttons:e,sticks:s},j)}function J(){a.AddEmulatedGamepad(0,!0,q,V),H(0),z(0,c),a.PressButton(0,x,1,!0),setTimeout(()=>{a.PressButton(0,x,0,!1)},2),window.onkeydown=e=>{const s=parseInt(e.key);e.key==="a"?a.MoveAxis(0,0,-1):e.key==="d"?a.MoveAxis(0,0,1):e.key==="w"?a.MoveAxis(0,1,-1):e.key==="s"?a.MoveAxis(0,1,1):e.key==="ArrowLeft"?(a.MoveAxis(0,2,-1),e.preventDefault()):e.key==="ArrowRight"?(a.MoveAxis(0,2,1),e.preventDefault()):e.key==="ArrowUp"?(a.MoveAxis(0,3,-1),e.preventDefault()):e.key==="ArrowDown"?(a.MoveAxis(0,3,1),e.preventDefault()):isNaN(s)?e.keyCode&&a.PressButton(0,e.keyCode-66+10,1,!0):a.PressButton(0,s,1,!0)},window.onkeyup=e=>{const s=parseInt(e.key);e.key==="a"||e.key==="d"?a.MoveAxis(0,b,0):e.key==="w"||e.key==="s"?a.MoveAxis(0,P,0):e.key==="ArrowLeft"||e.key==="ArrowRight"?(a.MoveAxis(0,T,0),e.preventDefault()):e.key==="ArrowUp"||e.key==="ArrowDown"?(a.MoveAxis(0,I,0),e.preventDefault()):isNaN(s)?e.keyCode&&a.PressButton(0,e.keyCode-66+10,0,!1):a.PressButton(0,s,0,!1)}}globalThis.onGameReady=()=>{var t;(t=document.querySelector("#loading-msg"))==null||t.remove(),document.querySelectorAll(".gpad-display").forEach(e=>{e.classList.remove("hidden")}),J()};const Y="modulepreload",$=function(t){return"/virtual-gamepad-lib/"+t},w={},K=function(e,s,n){let h=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),p=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));h=Promise.all(s.map(u=>{if(u=$(u),u in w)return;w[u]=!0;const _=u.endsWith(".css"),f=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const d=document.createElement("link");if(d.rel=_?"stylesheet":Y,_||(d.as="script",d.crossOrigin=""),d.href=u,p&&d.setAttribute("nonce",p),document.head.appendChild(d),_)return new Promise((E,D)=>{d.addEventListener("load",E),d.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${u}`)))})}))}return h.then(()=>e()).catch(l=>{const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=l,window.dispatchEvent(p),!p.defaultPrevented)throw l})},Z="/virtual-gamepad-lib/assets/space-CVr01FEs.png",Q="/virtual-gamepad-lib/assets/space-CdjOIDe1.json",ee="/virtual-gamepad-lib/assets/explosion-DEnJI5xL.json",te="/virtual-gamepad-lib/assets/explosion-BthNb2Mv.png",ie="/virtual-gamepad-lib/assets/nebula-CGbfovh_.jpg";K(()=>import("./phaser-wt8jUpzW.js"),[]).then(()=>{const t=window.Phaser;var e={type:t.AUTO,parent:"phaser-example",width:800,height:600,input:{gamepad:!0},physics:{default:"arcade",arcade:{debug:!1,fps:60,gravity:{y:0}}},scene:{preload:S,create:G,update:B,extend:{checkBulletVsEnemy:L,launchEnemy:N,hitShip:U,hitEnemy:X}}},s,n,h,l,p,u=0,_,f,d;new t.Game(e);var E=new t.Class({Extends:t.Physics.Arcade.Image,initialize:function(r){t.Physics.Arcade.Image.call(this,r,0,0,"space","blaster"),this.setBlendMode(1),this.setDepth(1),this.speed=800,this.lifespan=1e3,this._temp=new t.Math.Vector2},fire:function(i){this.lifespan=1e3,this.setActive(!0),this.setVisible(!0),this.setAngle(i.body.rotation),this.setPosition(i.x,i.y),this.body.reset(i.x,i.y),this.body.setSize(10,10,!0);var r=t.Math.DegToRad(i.body.rotation);this.scene.physics.velocityFromRotation(r,this.speed,this.body.velocity),this.body.velocity.x*=2,this.body.velocity.y*=2},update:function(i,r){this.lifespan-=r,this.lifespan<=0&&this.kill()},kill:function(){this.setActive(!1),this.setVisible(!1),this.body.stop()}}),D=new t.Class({Extends:t.Physics.Arcade.Sprite,initialize:function(r){t.Physics.Arcade.Sprite.call(this,r,0,0,"mine-sheet"),this.setDepth(1),this.speed=100,this.checkOutOfBounds=!1,this.target=new t.Math.Vector2},launch:function(){this.play("mine-anim"),this.checkOutOfBounds=!1;var i=t.Geom.Rectangle.RandomOutside(d,f);f.getRandomPoint(this.target),this.speed=t.Math.Between(100,400),this.setActive(!0),this.setVisible(!0),this.setPosition(i.x,i.y),this.body.reset(i.x,i.y);var r=t.Math.Angle.BetweenPoints(i,this.target);this.scene.physics.velocityFromRotation(r,this.speed,this.body.velocity)},update:function(i,r){var y=f.contains(this.x,this.y);!this.checkOutOfBounds&&y?this.checkOutOfBounds=!0:this.checkOutOfBounds&&!y&&this.kill()},kill:function(){this.setActive(!1),this.setVisible(!1),this.body.stop(),this.scene.launchEnemy()}});function S(){this.load.image("background",ie),this.load.atlas("space",Z,Q),this.load.atlas("explosion",te,ee)}function G(){this.add.sprite(0,0,"test"),d=new t.Geom.Rectangle(-200,-200,1200,1e3),f=new t.Geom.Rectangle(0,0,800,600),this.textures.addSpriteSheetFromAtlas("mine-sheet",{atlas:"space",frame:"mine",frameWidth:64}),this.anims.create({key:"mine-anim",frames:this.anims.generateFrameNumbers("mine-sheet",{start:0,end:15}),frameRate:20,repeat:-1}),this.add.tileSprite(400,300,800,600,"background"),this.add.image(0,0,"space","purple-planet").setOrigin(0),l=this.physics.add.group({classType:E,maxSize:30,runChildUpdate:!0}),s=this.physics.add.image(400,300,"space","ship").setDepth(2),s.setDamping(!0),s.setDrag(.95),s.setMaxVelocity(400),p=this.physics.add.group({classType:D,maxSize:60,runChildUpdate:!0}),h=this.add.text(10,10,"Press a button on the Gamepad to use",{font:"16px Courier",fill:"#00ff00"}),this.input.gamepad.on("down",function(g,A,v){g.getAxisTotal()<4?h.setText("Gamepad does not have enough axis for a twin-stick demo"):(h.setText("Left Stick to move, Right Stick to shoot"),g.setAxisThreshold(.3),n=g)},this),_=this.add.particles("explosion"),_.createEmitter({frame:"red",angle:{min:0,max:360,steps:32},lifespan:1e3,speed:400,quantity:32,scale:{start:.3,end:0},on:!1}),_.createEmitter({frame:"muzzleflash2",lifespan:200,scale:{start:2,end:0},rotate:{start:0,end:180},on:!1});var i=this.add.particles("space"),r=i.createEmitter({frame:"blue",speed:200,lifespan:{onEmit:function(g,A,v,k){return t.Math.Percent(s.body.speed,0,400)*2e3}},alpha:{onEmit:function(g,A,v,k){return t.Math.Percent(s.body.speed,0,400)}},angle:{onEmit:function(g,A,v,k){var C=0;return s.angle-180+C}},scale:{start:.6,end:0},blendMode:"ADD"});r.startFollow(s),this.physics.add.overlap(l,p,this.hitEnemy,this.checkBulletVsEnemy,this);for(var y=0;y<6;y++)this.launchEnemy();globalThis.onGameReady()}function N(){var i=p.get();i&&i.launch()}function L(i,r){return i.active&&r.active}function U(i,r){}function X(i,r){_.emitParticleAt(r.x,r.y),this.cameras.main.shake(500,.01),i.kill(),r.kill()}function B(i){if(n&&(h.setText([n.leftStick.x,s.body.angularVelocity]),s.setAngularVelocity(300*n.leftStick.x),n.leftStick.y<=0&&this.physics.velocityFromRotation(s.rotation,Math.abs(800*n.leftStick.y),s.body.acceleration),this.physics.world.wrap(s,32),n.A&&i>u)){var r=l.get();r&&(r.fire(s),u=i+100)}}});
