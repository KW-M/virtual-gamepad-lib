import{G as O,a as R,D as q,d as V,b as E,c as o,C as F}from"./GamepadApiWrapper-BpykGpSM.js";import{G as j}from"./GamepadDisplay-DLrf97No.js";const r=new O(.1),W=new R({updateDelay:0,axisDeadZone:.05}),c=document.body,b=8,P=0,T=1,I=2,w=3,S=["button_1","button_2","button_3","button_4","shoulder_button_front_left","shoulder_button_front_right","shoulder_trigger_back_left","shoulder_trigger_back_right","select_button","start_button","stick_button_left","stick_button_right","d_pad_up","d_pad_down","d_pad_left","d_pad_right"];function z(t,e){const s=S.map((h,_)=>h.includes("trigger")?{buttonIndex:_,type:E.variable,tapTarget:e.querySelector("#"+h+"_touch_target"),dragDistance:50,lockTargetWhilePressed:!0,directions:{[o.up]:!1,[o.down]:!0,[o.left]:!1,[o.right]:!1}}:{buttonIndex:_,type:E.onOff,lockTargetWhilePressed:h.includes("stick"),tapTarget:e.querySelector("#"+h+"_touch_target")});r.AddDisplayButtonEventListeners(t,s);const n=[{tapTarget:e.querySelector("#stick_button_left_touch_target"),dragDistance:30,xAxisIndex:0,yAxisIndex:1,lockTargetWhilePressed:!0,directions:{[o.up]:!0,[o.down]:!1,[o.left]:!0,[o.right]:!0}},{tapTarget:e.querySelector("#stick_button_right_touch_target"),dragDistance:30,xAxisIndex:2,yAxisIndex:3,lockTargetWhilePressed:!0,directions:{[o.up]:!0,[o.down]:!0,[o.left]:!0,[o.right]:!0}}];r.AddDisplayJoystickEventListeners(t,n)}function H(t){document.querySelectorAll("#stick_right, #stick_left").forEach(n=>{F(n)});const e=S.map((n,h)=>(console.log(n),n.includes("trigger")?{type:E.variable,highlight:c.querySelector("#"+n+"_highlight"),buttonElement:c.querySelector("#"+n),direction:o.down,directionHighlight:c.querySelector("#"+n+"_direction_highlight"),movementRange:10,extraData:{myCustomData:"variable btn name is "+n}}:{type:E.onOff,highlight:c.querySelector("#"+n+"_highlight"),extraData:{myCustomData:"onOff btn name is "+n}})),s=[{joystickElement:c.querySelector("#stick_left"),xAxisIndex:0,yAxisIndex:1,movementRange:10,highlights:{[o.up]:c.querySelector("#l_stick_up_direction_highlight"),[o.down]:c.querySelector("#l_stick_down_direction_highlight"),[o.left]:c.querySelector("#l_stick_left_direction_highlight"),[o.right]:c.querySelector("#l_stick_right_direction_highlight")}},{joystickElement:c.querySelector("#stick_right"),xAxisIndex:2,yAxisIndex:3,movementRange:10,highlights:{[o.up]:c.querySelector("#r_stick_up_direction_highlight"),[o.down]:c.querySelector("#r_stick_down_direction_highlight"),[o.left]:c.querySelector("#r_stick_left_direction_highlight"),[o.right]:c.querySelector("#r_stick_right_direction_highlight")}}];new j({gamepadIndex:t,pressedHighlightClass:"pressed",touchedHighlightClass:"touched",moveDirectionHighlightClass:"moved",buttons:e,sticks:s},W)}function J(){r.AddEmulatedGamepad(0,!0,q,V),H(0),z(0,c),r.PressButton(0,b,1,!0),setTimeout(()=>{r.PressButton(0,b,0,!1)},2),window.onkeydown=e=>{const s=parseInt(e.key);e.key==="a"?r.MoveAxis(0,0,-1):e.key==="d"?r.MoveAxis(0,0,1):e.key==="w"?r.MoveAxis(0,1,-1):e.key==="s"?r.MoveAxis(0,1,1):e.key==="ArrowLeft"?(r.MoveAxis(0,2,-1),e.preventDefault()):e.key==="ArrowRight"?(r.MoveAxis(0,2,1),e.preventDefault()):e.key==="ArrowUp"?(r.MoveAxis(0,3,-1),e.preventDefault()):e.key==="ArrowDown"?(r.MoveAxis(0,3,1),e.preventDefault()):isNaN(s)?e.keyCode&&r.PressButton(0,e.keyCode-66+10,1,!0):r.PressButton(0,s,1,!0)},window.onkeyup=e=>{const s=parseInt(e.key);e.key==="a"||e.key==="d"?r.MoveAxis(0,P,0):e.key==="w"||e.key==="s"?r.MoveAxis(0,T,0):e.key==="ArrowLeft"||e.key==="ArrowRight"?(r.MoveAxis(0,I,0),e.preventDefault()):e.key==="ArrowUp"||e.key==="ArrowDown"?(r.MoveAxis(0,w,0),e.preventDefault()):isNaN(s)?e.keyCode&&r.PressButton(0,e.keyCode-66+10,0,!1):r.PressButton(0,s,0,!1)}}globalThis.onGameReady=()=>{var t;(t=document.querySelector("#loading-msg"))==null||t.remove(),document.querySelectorAll(".gpad-display").forEach(e=>{e.classList.remove("hidden")}),J()};const Y="modulepreload",$=function(t){return"/virtual-gamepad-lib/"+t},M={},K=function(e,s,n){let h=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),d=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));h=Promise.allSettled(s.map(u=>{if(u=$(u),u in M)return;M[u]=!0;const f=u.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const p=document.createElement("link");if(p.rel=f?"stylesheet":Y,f||(p.as="script"),p.crossOrigin="",p.href=u,d&&p.setAttribute("nonce",d),document.head.appendChild(p),f)return new Promise((D,A)=>{p.addEventListener("load",D),p.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${u}`)))})}))}function _(l){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=l,window.dispatchEvent(d),!d.defaultPrevented)throw l}return h.then(l=>{for(const d of l||[])d.status==="rejected"&&_(d.reason);return e().catch(_)})},Z="/virtual-gamepad-lib/assets/space-CVr01FEs.png",Q="/virtual-gamepad-lib/assets/space-CdjOIDe1.json",ee="/virtual-gamepad-lib/assets/explosion-DEnJI5xL.json",te="/virtual-gamepad-lib/assets/explosion-BthNb2Mv.png",ie="/virtual-gamepad-lib/assets/nebula-CGbfovh_.jpg";K(()=>import("./phaser-wt8jUpzW.js"),[]).then(()=>{const t=window.Phaser;var e={type:t.AUTO,parent:"phaser-example",width:800,height:600,input:{gamepad:!0},physics:{default:"arcade",arcade:{debug:!1,fps:60,gravity:{y:0}}},scene:{preload:A,create:G,update:B,extend:{checkBulletVsEnemy:L,launchEnemy:N,hitShip:U,hitEnemy:X}}},s,n,h,_,l,d=0,u,f,m;new t.Game(e);var p=new t.Class({Extends:t.Physics.Arcade.Image,initialize:function(a){t.Physics.Arcade.Image.call(this,a,0,0,"space","blaster"),this.setBlendMode(1),this.setDepth(1),this.speed=800,this.lifespan=1e3,this._temp=new t.Math.Vector2},fire:function(i){this.lifespan=1e3,this.setActive(!0),this.setVisible(!0),this.setAngle(i.body.rotation),this.setPosition(i.x,i.y),this.body.reset(i.x,i.y),this.body.setSize(10,10,!0);var a=t.Math.DegToRad(i.body.rotation);this.scene.physics.velocityFromRotation(a,this.speed,this.body.velocity),this.body.velocity.x*=2,this.body.velocity.y*=2},update:function(i,a){this.lifespan-=a,this.lifespan<=0&&this.kill()},kill:function(){this.setActive(!1),this.setVisible(!1),this.body.stop()}}),D=new t.Class({Extends:t.Physics.Arcade.Sprite,initialize:function(a){t.Physics.Arcade.Sprite.call(this,a,0,0,"mine-sheet"),this.setDepth(1),this.speed=100,this.checkOutOfBounds=!1,this.target=new t.Math.Vector2},launch:function(){this.play("mine-anim"),this.checkOutOfBounds=!1;var i=t.Geom.Rectangle.RandomOutside(m,f);f.getRandomPoint(this.target),this.speed=t.Math.Between(100,400),this.setActive(!0),this.setVisible(!0),this.setPosition(i.x,i.y),this.body.reset(i.x,i.y);var a=t.Math.Angle.BetweenPoints(i,this.target);this.scene.physics.velocityFromRotation(a,this.speed,this.body.velocity)},update:function(i,a){var y=f.contains(this.x,this.y);!this.checkOutOfBounds&&y?this.checkOutOfBounds=!0:this.checkOutOfBounds&&!y&&this.kill()},kill:function(){this.setActive(!1),this.setVisible(!1),this.body.stop(),this.scene.launchEnemy()}});function A(){this.load.image("background",ie),this.load.atlas("space",Z,Q),this.load.atlas("explosion",te,ee)}function G(){this.add.sprite(0,0,"test"),m=new t.Geom.Rectangle(-200,-200,1200,1e3),f=new t.Geom.Rectangle(0,0,800,600),this.textures.addSpriteSheetFromAtlas("mine-sheet",{atlas:"space",frame:"mine",frameWidth:64}),this.anims.create({key:"mine-anim",frames:this.anims.generateFrameNumbers("mine-sheet",{start:0,end:15}),frameRate:20,repeat:-1}),this.add.tileSprite(400,300,800,600,"background"),this.add.image(0,0,"space","purple-planet").setOrigin(0),_=this.physics.add.group({classType:p,maxSize:30,runChildUpdate:!0}),s=this.physics.add.image(400,300,"space","ship").setDepth(2),s.setDamping(!0),s.setDrag(.95),s.setMaxVelocity(400),l=this.physics.add.group({classType:D,maxSize:60,runChildUpdate:!0}),h=this.add.text(10,10,"Press a button on the Gamepad to use",{font:"16px Courier",fill:"#00ff00"}),this.input.gamepad.on("down",function(g,v,k){g.getAxisTotal()<4?h.setText("Gamepad does not have enough axis for a twin-stick demo"):(h.setText("Left Stick to move, Right Stick to shoot"),g.setAxisThreshold(.3),n=g)},this),u=this.add.particles("explosion"),u.createEmitter({frame:"red",angle:{min:0,max:360,steps:32},lifespan:1e3,speed:400,quantity:32,scale:{start:.3,end:0},on:!1}),u.createEmitter({frame:"muzzleflash2",lifespan:200,scale:{start:2,end:0},rotate:{start:0,end:180},on:!1});var i=this.add.particles("space"),a=i.createEmitter({frame:"blue",speed:200,lifespan:{onEmit:function(g,v,k,x){return t.Math.Percent(s.body.speed,0,400)*2e3}},alpha:{onEmit:function(g,v,k,x){return t.Math.Percent(s.body.speed,0,400)}},angle:{onEmit:function(g,v,k,x){var C=0;return s.angle-180+C}},scale:{start:.6,end:0},blendMode:"ADD"});a.startFollow(s),this.physics.add.overlap(_,l,this.hitEnemy,this.checkBulletVsEnemy,this);for(var y=0;y<6;y++)this.launchEnemy();globalThis.onGameReady()}function N(){var i=l.get();i&&i.launch()}function L(i,a){return i.active&&a.active}function U(i,a){}function X(i,a){u.emitParticleAt(a.x,a.y),this.cameras.main.shake(500,.01),i.kill(),a.kill()}function B(i){if(n&&(h.setText([n.leftStick.x,s.body.angularVelocity]),s.setAngularVelocity(300*n.leftStick.x),n.leftStick.y<=0&&this.physics.velocityFromRotation(s.rotation,Math.abs(800*n.leftStick.y),s.body.acceleration),this.physics.world.wrap(s,32),n.A&&i>d)){var a=_.get();a&&(a.fire(s),d=i+100)}}});
