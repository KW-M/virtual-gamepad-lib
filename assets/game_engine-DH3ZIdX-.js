import{G,a as O,c as g,s as h}from"./GamepadEmulator-CNWoeGf3.js";import{s as T}from"./helpers-DCx76efX.js";import{L,R as C}from"./display-gamepad-right-DqjVesqr.js";import"./GamepadDisplay-3X_eRe0j.js";const o=new G(.1),I=new O({updateDelay:0,axisDeadZone:.05});globalThis.onGameReady=()=>{const a=document.getElementById("gpad_display_container"),m=document.getElementById("loading-msg");m==null||m.remove(),document.getElementById("gpad_display_left").innerHTML=L,document.getElementById("gpad_display_right").innerHTML=C;const e=0;T(a,{AllowDpadDiagonals:!0,GpadEmulator:o,GpadApiWrapper:I,EmulatedGamepadIndex:e,EmulatedGamepadOverlayMode:!0}),o.PressButton(e,g.Start,1,!0),setTimeout(()=>{o.PressButton(e,g.Start,0,!1)},10);const r=new Set;window.onkeydown=s=>{if(s.shiftKey||s.altKey||s.metaKey)return;const n=s.key.toLowerCase();r.add(n);const l=parseInt(n),c=s.ctrlKey;n==="a"?o.MoveAxis(e,h.LStickX,-1):n==="d"?o.MoveAxis(e,h.LStickX,1):n==="w"?o.MoveAxis(e,h.LStickY,-1):n==="s"?o.MoveAxis(e,h.LStickY,1):n==="arrowleft"?(o.MoveAxis(e,h.RStickX,-1),s.preventDefault()):n==="arrowright"?(o.MoveAxis(e,h.RStickX,1),s.preventDefault()):n==="arrowup"?(o.MoveAxis(e,h.RStickY,-1),s.preventDefault()):n==="arrowdown"?(o.MoveAxis(e,h.RStickY,1),s.preventDefault()):isNaN(l)?n===" "&&o.PressButton(e,g.A,c?0:1,!0):o.PressButton(e,l,c?0:1,!0)},window.onkeyup=s=>{if(s.shiftKey||s.altKey||s.metaKey)return;r.delete(s.key.toLowerCase());const n=parseInt(s.key);!r.has("a")&&!r.has("d")&&o.MoveAxis(e,h.LStickX,0),!r.has("w")&&!r.has("s")&&o.MoveAxis(e,h.LStickY,0),!r.has("arrowleft")&&!r.has("arrowright")&&o.MoveAxis(e,h.RStickX,0),!r.has("arrowup")&&!r.has("arrowdown")&&o.MoveAxis(e,h.RStickY,0),isNaN(n)?s.key===" "&&o.PressButton(e,g.A,0,!1):o.PressButton(e,n,0,!1)}};const V="modulepreload",K=function(a){return"/virtual-gamepad-lib/"+a},A={},F=function(m,e,r){let s=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(e.map(d=>{if(d=K(d),d in A)return;A[d]=!0;const p=d.endsWith(".css"),v=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${v}`))return;const u=document.createElement("link");if(u.rel=p?"stylesheet":V,p||(u.as="script"),u.crossOrigin="",u.href=d,c&&u.setAttribute("nonce",c),document.head.appendChild(u),p)return new Promise((k,x)=>{u.addEventListener("load",k),u.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function n(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return s.then(l=>{for(const c of l||[])c.status==="rejected"&&n(c.reason);return m().catch(n)})},U="/virtual-gamepad-lib/assets/space-CVr01FEs.png",N="/virtual-gamepad-lib/assets/space-CdjOIDe1.json",z="/virtual-gamepad-lib/assets/explosion-DEnJI5xL.json",X="/virtual-gamepad-lib/assets/explosion-BthNb2Mv.png",Y="/virtual-gamepad-lib/assets/nebula-CGbfovh_.jpg";F(()=>import("./phaser-wt8jUpzW.js"),[]).then(()=>{const a=window.Phaser;var m={type:a.AUTO,parent:"phaser-example",width:800,height:600,input:{gamepad:!0},physics:{default:"arcade",arcade:{debug:!1,fps:60,gravity:{y:0}}},scene:{preload:x,create:P,update:M,extend:{checkBulletVsEnemy:D,launchEnemy:S,hitShip:R,hitEnemy:B}}},e,r,s,n,l,c=0,d,p,v;new a.Game(m);var u=new a.Class({Extends:a.Physics.Arcade.Image,initialize:function(i){a.Physics.Arcade.Image.call(this,i,0,0,"space","blaster"),this.setBlendMode(1),this.setDepth(1),this.speed=800,this.lifespan=1e3,this._temp=new a.Math.Vector2},fire:function(t){this.lifespan=1e3,this.setActive(!0),this.setVisible(!0),this.setAngle(t.body.rotation),this.setPosition(t.x,t.y),this.body.reset(t.x,t.y),this.body.setSize(10,10,!0);var i=a.Math.DegToRad(t.body.rotation);this.scene.physics.velocityFromRotation(i,this.speed,this.body.velocity),this.body.velocity.x*=2,this.body.velocity.y*=2},update:function(t,i){this.lifespan-=i,this.lifespan<=0&&this.kill()},kill:function(){this.setActive(!1),this.setVisible(!1),this.body.stop()}}),k=new a.Class({Extends:a.Physics.Arcade.Sprite,initialize:function(i){a.Physics.Arcade.Sprite.call(this,i,0,0,"mine-sheet"),this.setDepth(1),this.speed=100,this.checkOutOfBounds=!1,this.target=new a.Math.Vector2},launch:function(){this.play("mine-anim"),this.checkOutOfBounds=!1;var t=a.Geom.Rectangle.RandomOutside(v,p);p.getRandomPoint(this.target),this.speed=a.Math.Between(100,400),this.setActive(!0),this.setVisible(!0),this.setPosition(t.x,t.y),this.body.reset(t.x,t.y);var i=a.Math.Angle.BetweenPoints(t,this.target);this.scene.physics.velocityFromRotation(i,this.speed,this.body.velocity)},update:function(t,i){var y=p.contains(this.x,this.y);!this.checkOutOfBounds&&y?this.checkOutOfBounds=!0:this.checkOutOfBounds&&!y&&this.kill()},kill:function(){this.setActive(!1),this.setVisible(!1),this.body.stop(),this.scene.launchEnemy()}});function x(){this.load.image("background",Y),this.load.atlas("space",U,N),this.load.atlas("explosion",X,z)}function P(){this.add.sprite(0,0,"test"),v=new a.Geom.Rectangle(-200,-200,1200,1e3),p=new a.Geom.Rectangle(0,0,800,600),this.textures.addSpriteSheetFromAtlas("mine-sheet",{atlas:"space",frame:"mine",frameWidth:64}),this.anims.create({key:"mine-anim",frames:this.anims.generateFrameNumbers("mine-sheet",{start:0,end:15}),frameRate:20,repeat:-1}),this.add.tileSprite(400,300,800,600,"background"),this.add.image(0,0,"space","purple-planet").setOrigin(0),n=this.physics.add.group({classType:u,maxSize:30,runChildUpdate:!0}),e=this.physics.add.image(400,300,"space","ship").setDepth(2),e.setDamping(!0),e.setDrag(.95),e.setMaxVelocity(400),l=this.physics.add.group({classType:k,maxSize:60,runChildUpdate:!0}),s=this.add.text(10,10,"Press a button on the Gamepad to use",{font:"16px Courier",fill:"#00ff00"}),this.input.gamepad.on("down",function(f,b,E){f.getAxisTotal()<4?s.setText("Gamepad does not have enough axis for a twin-stick demo"):(s.setText("Left Stick to move, Right Stick to shoot"),f.setAxisThreshold(.3),r=f)},this),d=this.add.particles("explosion"),d.createEmitter({frame:"red",angle:{min:0,max:360,steps:32},lifespan:1e3,speed:400,quantity:32,scale:{start:.3,end:0},on:!1}),d.createEmitter({frame:"muzzleflash2",lifespan:200,scale:{start:2,end:0},rotate:{start:0,end:180},on:!1});var t=this.add.particles("space"),i=t.createEmitter({frame:"blue",speed:200,lifespan:{onEmit:function(f,b,E,w){return a.Math.Percent(e.body.speed,0,400)*2e3}},alpha:{onEmit:function(f,b,E,w){return a.Math.Percent(e.body.speed,0,400)}},angle:{onEmit:function(f,b,E,w){var _=0;return e.angle-180+_}},scale:{start:.6,end:0},blendMode:"ADD"});i.startFollow(e),this.physics.add.overlap(n,l,this.hitEnemy,this.checkBulletVsEnemy,this);for(var y=0;y<6;y++)this.launchEnemy();globalThis.onGameReady()}function S(){var t=l.get();t&&t.launch()}function D(t,i){return t.active&&i.active}function R(t,i){}function B(t,i){d.emitParticleAt(i.x,i.y),this.cameras.main.shake(500,.01),t.kill(),i.kill()}function M(t){if(r&&(s.setText([r.leftStick.x,e.body.angularVelocity]),e.setAngularVelocity(300*r.leftStick.x),r.leftStick.y<=0&&this.physics.velocityFromRotation(e.rotation,Math.abs(800*r.leftStick.y),e.body.acceleration),this.physics.world.wrap(e,32),r.A&&t>c)){var i=n.get();i&&(i.fire(e),c=t+100)}}});
