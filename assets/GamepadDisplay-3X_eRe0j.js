var p=Object.defineProperty;var f=(d,i,o)=>i in d?p(d,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):d[i]=o;var g=(d,i,o)=>f(d,typeof i!="symbol"?i+"":i,o);import{a as m,e as a,g as u}from"./GamepadEmulator-CNWoeGf3.js";class x{constructor(i,o){g(this,"config");g(this,"apiWrapper");g(this,"DefaultJoystickDisplayFunction",(i,o,h)=>{const l=i.movementRange;if(i.joystickElement.style.transform=`translate(${o*l}px,${h*l}px)`,i.highlights&&this.config.moveDirectionHighlightClass){const s=i.highlights[a.up],t=i.highlights[a.down],e=i.highlights[a.left],n=i.highlights[a.right];s&&h<-.1?s.classList.add(this.config.moveDirectionHighlightClass||""):s&&s.classList.remove(this.config.moveDirectionHighlightClass||""),t&&h>.1?t.classList.add(this.config.moveDirectionHighlightClass||""):t&&t.classList.remove(this.config.moveDirectionHighlightClass||""),e&&o<-.1?e.classList.add(this.config.moveDirectionHighlightClass||""):e&&e.classList.remove(this.config.moveDirectionHighlightClass||""),n&&o>.1?n.classList.add(this.config.moveDirectionHighlightClass||""):n&&n.classList.remove(this.config.moveDirectionHighlightClass||"")}});g(this,"DefaultButtonDisplayFunction",(i,o,h,l,s,t)=>{const e=i.highlight;if(this.config.touchedHighlightClass&&e&&(s.touchDown?e.classList.add(this.config.touchedHighlightClass):s.touchUp&&e.classList.remove(this.config.touchedHighlightClass)),this.config.pressedHighlightClass&&e&&(s.pressed?e.classList.add(this.config.pressedHighlightClass):s.released&&e.classList.remove(this.config.pressedHighlightClass)),i.type==u.variable){const n=i.directionHighlight;if(this.config.moveDirectionHighlightClass&&n&&(s.pressed?n.classList.add(this.config.moveDirectionHighlightClass):s.released&&n.classList.remove(this.config.moveDirectionHighlightClass)),i.buttonElement){const c=i.direction==a.left||i.direction==a.right,r=i.direction==a.right||i.direction==a.down;i.buttonElement.style.transform=`translate${c?"X":"Y"}(${r?"":"-"}${o*i.movementRange}px)`}}});g(this,"displayJoystickChanges",(i,o,h)=>{if(i!=this.config.gamepadIndex)return;const l=this.config.sticks;for(let s=0;s<l.length;s++){const t=l[s];if(t&&(t.xAxisIndex!==void 0&&h[t.xAxisIndex]||t.yAxisIndex!==void 0&&h[t.yAxisIndex])){const e=o.axes,n=t.xAxisIndex!==void 0&&e[t.xAxisIndex]||0,c=t.yAxisIndex!==void 0&&e[t.yAxisIndex]||0;this.config.joystickDisplayFunction?this.config.joystickDisplayFunction(t,n,c):this.DefaultJoystickDisplayFunction(t,n,c)}}});g(this,"displayButtonChanges",(i,o,h)=>{if(i!=this.config.gamepadIndex)return;const l=this.config.buttons;for(let s=0;s<l.length;s++){const t=l[s],e=h[s];if(!t||Object.keys(t).length==0||!e||Object.keys(e).length==0)continue;const n=o.buttons[s].value,c=o.buttons[s].touched,r=o.buttons[s].pressed;this.config.buttonDisplayFunction?this.config.buttonDisplayFunction(t,n,c,r,e,s):this.DefaultButtonDisplayFunction(t,n,c,r,e,s)}});var h,l;this.config=Object.assign({gamepadIndex:0,buttons:[],sticks:[],touchedHighlightClass:"touched",pressedHighlightClass:"pressed",moveDirectionHighlightClass:"active"},i),this.apiWrapper=o||new m({buttonConfigs:[],updateDelay:0}),((h=this.config.buttons)==null?void 0:h.length)!==0&&this.apiWrapper.onGamepadButtonChange(this.displayButtonChanges),((l=this.config.sticks)==null?void 0:l.length)!==0&&this.apiWrapper.onGamepadAxisChange(this.displayJoystickChanges)}Cleanup(){this.apiWrapper.offGamepadButtonChange(this.displayButtonChanges),this.apiWrapper.offGamepadAxisChange(this.displayJoystickChanges)}}export{x as G};
